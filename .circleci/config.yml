version: 2.1
orbs:
  cypress: cypress-io/cypress@1
  react: thefrontside/react@0.1.0
workflows:
  push:
    jobs:
      client:
        - working_directory: ~/devops-boilerplate/
        - cd devops-boilerplate/react-client react/install
        - cd devops-boilerplate/express-server npm install
        - react/test:
            requires:
              - cd react-client react/install
              - cd express-server npm install

  build:
    jobs:
      - cypress/run:
        - working_directory: ~/devops-boilerplate/
          start: cd devops-boilerplate/react-client npm start
          wait-on: 'http://localhost:3000'
          no-workspace: true